<!DOCTYPE html>
<html>
<head>
    <title>Google Sheets Test</title>
    <style>
        body { font-family: Arial; max-width: 800px; margin: 40px auto; padding: 20px; }
        .test-container { background: white; padding: 30px; border-radius: 10px; }
        button { background: #4CAF50; color: white; padding: 12px 24px; border: none; border-radius: 5px; cursor: pointer; margin: 10px 5px; }
        .error { background: #ffebee; border-left: 4px solid #f44336; padding: 10px; margin: 10px 0; }
        .success { background: #e8f5e8; border-left: 4px solid #4CAF50; padding: 10px; margin: 10px 0; }
        .info { background: #e3f2fd; border-left: 4px solid #2196F3; padding: 10px; margin: 10px 0; }
        pre { background: #f4f4f4; padding: 15px; border-radius: 5px; overflow-x: auto; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ðŸ§ª Google Sheets Integration Test</h1>
        
        <div class="info">
            <strong>Your Script URL:</strong><br>
            <code>https://script.google.com/macros/s/AKfycbzuzqJ7EI1Ym7pIlf7GLj_UYzp8K70DFCDJFfF81f2VqDy0MEBd39M0JTQ9MVlychWesw/exec</code>
        </div>
        
        <div class="info">
            <strong>Your Google Sheet:</strong><br>
            <a href="https://docs.google.com/spreadsheets/d/1yzDei15AAxL6CuR_0YXtjh3-2o9VY4Q0JYbXJniuzIs/edit?gid=0#gid=0" target="_blank">Open Google Sheet</a>
        </div>
        
        <button onclick="testGetRequest()">1. Test GET Request</button>
        <button onclick="testPostRequest()">2. Test POST Request</button>
        <button onclick="clearResults()">Clear Results</button>
        
        <div id="results"></div>
    </div>

    <script>
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzuzqJ7EI1Ym7pIlf7GLj_UYzp8K70DFCDJFfF81f2VqDy0MEBd39M0JTQ9MVlychWesw/exec';
        
        function log(message, type = 'info') {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = type;
            div.innerHTML = `<strong>${new Date().toLocaleTimeString()}:</strong> ${message}`;
            results.appendChild(div);
        }
        
        async function testGetRequest() {
            log('ðŸ”„ Testing GET request...', 'info');
            try {
                const response = await fetch(SCRIPT_URL);
                log(`GET Status: ${response.status}`, response.ok ? 'success' : 'error');
                
                if (response.ok) {
                    const text = await response.text();
                    log('GET Success: ' + text, 'success');
                }
            } catch (error) {
                log(`GET Error: ${error.message}`, 'error');
            }
        }
        
        async function testPostRequest() {
            log('ðŸ”„ Testing POST request...', 'info');
            
            const testData = {
                timestamp: new Date().toISOString(),
                firstName: 'Test',
                lastName: 'User',
                email: 'test@example.com',
                phone: '+1-555-TEST',
                company: 'Test Company',
                eventTypes: 'Corporate Events',
                referralSource: 'Manual Test'
            };
            
            try {
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(testData)
                });
                
                log(`POST Status: ${response.status}`, response.ok ? 'success' : 'error');
                
                if (response.ok) {
                    const text = await response.text();
                    log('POST Success: ' + text, 'success');
                    log('âœ… Check your Google Sheet for new data!', 'success');
                }
            } catch (error) {
                log(`POST Error: ${error.message}`, 'error');
            }
        }
        
        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }
    </script>
</body>
</html>